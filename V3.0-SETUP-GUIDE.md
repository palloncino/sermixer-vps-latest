# SERMIXER V3.0 SETUP GUIDE

## **ğŸ¯ OVERVIEW**
This guide documents the setup of SERMIXER v3.0 alongside the existing v2.0 production system. The v3.0 applications run independently without affecting the current production traffic.

## **ğŸ“ DIRECTORY STRUCTURE**
```
/var/www/
â”œâ”€â”€ v2.0/                    # Production Frontend (unchanged)
â”œâ”€â”€ server-v2.0/             # Production Backend (unchanged)
â”œâ”€â”€ v3.0/                    # Development Frontend (NEW)
â”œâ”€â”€ server-v3.0/             # Development Backend (NEW)
â””â”€â”€ database-backups/         # Database backups
```

## **ğŸŒ TRAFFIC ROUTING**

### **V2.0 (Production - Unchanged)**
- **Frontend**: `http://sermixer.micro-cloud.it/` (root)
- **Backend API**: `http://sermixer.micro-cloud.it/api` â†’ Port 5004
- **Database**: `quotation-sql-database-01`

### **V3.0 (Development - NEW)**
- **Frontend**: `http://sermixer.micro-cloud.it/v3.0/`
- **Backend API**: `http://sermixer.micro-cloud.it/v3.0/api` â†’ Port 5006
- **Database**: `quotation-sql-database-v3.0`

## **ğŸ”§ CONFIGURATION FILES**

### **NGINX Configuration**
- **Main Config**: `/etc/nginx/sites-available/sermixer`
- **Backup**: `/etc/nginx/sites-available/sermixer.backup`
- **V3.0 Routes**: Added to main configuration

### **Environment Files**
- **V2.0**: `/var/www/server-v2.0/.env.remote`
- **V3.0**: `/var/www/server-v3.0/.env`

### **PM2 Configurations**
- **V2.0**: `/var/www/ecosystem.config.js`
- **V3.0**: `/var/www/ecosystem-v3.0.config.js`

## **ğŸš€ STARTING V3.0 APPLICATIONS**

### **1. Install Dependencies**
```bash
cd /var/www/server-v3.0
npm install

cd /var/www/v3.0
npm install
```

### **2. Start V3.0 Backend**
```bash
cd /var/www/server-v3.0
npm start
# OR using PM2
pm2 start /var/www/ecosystem-v3.0.config.js
```

### **3. Start V3.0 Frontend**
```bash
cd /var/www/v3.0
npm start
```

## **ğŸ—„ï¸ DATABASE SETUP**

### **V3.0 Database**
- **Name**: `quotation-sql-database-v3.0`
- **Status**: Created and ready
- **Migration**: Use the backup from v2.0 to populate v3.0

### **Database Migration Commands**
```bash
# Restore v2.0 data to v3.0 database
mysql -u root -p'86mcrw!p10' quotation-sql-database-v3.0 < /var/www/database-backups/v3.0_migration_backup_2025-08-20_12-20-29.sql
```

## **ğŸ” TESTING V3.0**

### **Frontend Testing**
- **URL**: `http://sermixer.micro-cloud.it/v3.0/`
- **Expected**: V3.0 React application loads

### **Backend Testing**
- **URL**: `http://sermixer.micro-cloud.it/v3.0/api/health`
- **Expected**: API responds on port 5006

### **Database Testing**
```bash
mysql -u root -p'86mcrw!p10' -e "USE quotation-sql-database-v3.0; SHOW TABLES;"
```

## **âš ï¸ IMPORTANT NOTES**

### **Port Management**
- **V2.0 Backend**: Port 5004 (production)
- **V3.0 Backend**: Port 5006 (development)
- **No conflicts** between versions

### **File Storage**
- **PDFs**: Shared `/var/www/pdfs/` (both versions)
- **Images**: Shared `/var/www/images/` (both versions)
- **Static Assets**: Separate for each version

### **Environment Isolation**
- **V2.0**: Uses `.env.remote`
- **V3.0**: Uses `.env`
- **Databases**: Completely separate

## **ğŸ”„ DEPLOYMENT WORKFLOW**

### **Development Phase**
1. Work on v3.0 applications
2. Test at `/v3.0/` endpoints
3. Keep v2.0 production running

### **Production Switch (Future)**
1. Test v3.0 thoroughly
2. Update NGINX to route root `/` to v3.0
3. Move v2.0 to `/v2.0/` (if needed)
4. Update DNS/network layer as required

## **ğŸ“‹ TROUBLESHOOTING**

### **Common Issues**
1. **Port Conflicts**: Ensure v3.0 uses port 5006
2. **Database Connection**: Verify v3.0 database exists
3. **NGINX Routes**: Check configuration syntax
4. **File Permissions**: Ensure proper ownership

### **Useful Commands**
```bash
# Check NGINX status
sudo systemctl status nginx

# Test NGINX config
sudo nginx -t

# Restart NGINX
sudo systemctl restart nginx

# Check PM2 processes
pm2 list

# View PM2 logs
pm2 logs sermixer-api-v3.0
```

## **ğŸ“… SETUP COMPLETED**
- **Date**: August 20, 2024
- **Status**: V3.0 infrastructure ready
- **Next Step**: Install dependencies and start applications

---

*This setup ensures v2.0 production remains completely untouched while providing a full development environment for v3.0.*
