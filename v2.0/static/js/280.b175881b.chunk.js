"use strict";(self.webpackChunkquotation_app_02=self.webpackChunkquotation_app_02||[]).push([[280],{646:(e,n,t)=>{t.d(n,{A:()=>c});t(5043);var o=t(5795),a=t(1787),r=t(9577),i=t(927),s=t(579);const l=(0,i.Ay)(o.A)`
  & .MuiInputBase-input {
    background: #fff;
    text-align: right;
  }
`,c=e=>{let{label:n,value:t,onChange:o,fullWidth:i=!1,sx:c,readOnly:d}=e;return(0,s.jsx)(r.HG,{customInput:l,label:n,value:t,onValueChange:e=>{const{formattedValue:n,value:t}=e;o(t)},thousandSeparator:".",decimalSeparator:",",decimalScale:2,fixedDecimalScale:!0,fullWidth:i,sx:c,InputProps:{startAdornment:(0,s.jsx)(a.A,{position:"start",children:"\u20ac"}),readOnly:!!d||void 0}})}},8751:(e,n,t)=>{t.d(n,{A:()=>s});var o=t(6446),a=t(4194),r=t(8911),i=t(579);const s=function(e){let{message:n,type:t}=e;return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(o.A,{py:2,children:(0,i.jsx)(r.A,{sx:{width:"100%"},spacing:2,children:(0,i.jsx)(a.A,{severity:t,children:n})})})})}},1052:(e,n,t)=>{t.d(n,{A:()=>i});t(5043);var o=t(2735),a=t(6446),r=t(579);const i=e=>{let{value:n,onChange:t,readOnly:i}=e;return(0,r.jsx)(a.A,{"data-color-mode":"light",children:(0,r.jsx)(o.Ay,{value:n,onChange:e=>t(e||""),preview:i?"preview":"edit",hideToolbar:i,height:400,visibleDragbar:!1})})}},1280:(e,n,t)=>{t.d(n,{A:()=>Y});var o=t(6446),a=t(8903),r=t(1906),i=t(7206),s=t(5043),l=t(4117),c=t(3216);const d={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};var p,m=new Uint8Array(16);function u(){if(!p&&!(p="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return p(m)}for(var h=[],g=0;g<256;++g)h.push((g+256).toString(16).slice(1));function x(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(h[e[n+0]]+h[e[n+1]]+h[e[n+2]]+h[e[n+3]]+"-"+h[e[n+4]]+h[e[n+5]]+"-"+h[e[n+6]]+h[e[n+7]]+"-"+h[e[n+8]]+h[e[n+9]]+"-"+h[e[n+10]]+h[e[n+11]]+h[e[n+12]]+h[e[n+13]]+h[e[n+14]]+h[e[n+15]]).toLowerCase()}const v=function(e,n,t){if(d.randomUUID&&!n&&!e)return d.randomUUID();var o=(e=e||{}).random||(e.rng||u)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,n){t=t||0;for(var a=0;a<16;++a)n[t+a]=o[a];return n}return x(o)};var j=t(690),A=t(7996),f=t(8751),y=t(5865),C=t(889),b=t(6605),U=t(7392),k=t(710),w=t(3691),R=t(2505),S=t(3608),I=t(977),P=t(1337),z=t(3471),D=t(5795),L=t(646),O=t(4535),W=t(2954),_=t(579);const M=(0,O.Ay)(o.A)((e=>{let{theme:n}=e;return{width:"100%",height:"200px",position:"relative",overflow:"hidden","&:hover .upload-overlay":{opacity:1}}})),B=(0,O.Ay)(o.A)((e=>{let{theme:n}=e;return{width:"100%",height:"100%",backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"top"}})),V=(0,O.Ay)(o.A)((e=>{let{theme:n}=e;return{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"rgba(0, 0, 0, 0.5)",opacity:0,transition:"opacity 0.3s"}})),$=e=>{let{previewUrl:n,onChange:t,label:o,imageStyle:a}=e;const i=(0,s.useRef)(null);return(0,_.jsxs)(M,{onClick:()=>{var e;null===(e=i.current)||void 0===e||e.click()},children:[(0,_.jsx)(B,{style:{backgroundImage:`url(${n})`,...a}}),(0,_.jsx)(V,{className:"upload-overlay",children:(0,_.jsx)(r.A,{variant:"contained",startIcon:(0,_.jsx)(W.A,{}),sx:{backgroundColor:"rgba(255, 255, 255, 0.8)",color:"black"},children:o})}),(0,_.jsx)("input",{type:"file",hidden:!0,ref:i,onChange:t,accept:"image/*"})]})},E=e=>{let{component:n,index:t,onChange:r,onImageChange:i,onRemove:c,getPreviewUrl:d}=e;const{t:p}=(0,l.Bd)(),m=(0,s.useCallback)((e=>{const{name:n,value:t}=e.target;r({[n]:t})}),[r]),u=(0,s.useCallback)((e=>{if(e.target.files&&e.target.files[0]){const n=e.target.files[0];r({image:n}),i(e)}}),[r,i]);return(0,_.jsx)(o.A,{sx:{p:2},children:(0,_.jsxs)(a.Ay,{container:!0,spacing:2,children:[(0,_.jsx)(a.Ay,{item:!0,xs:12,sm:4,children:(0,_.jsx)(o.A,{height:"200px",children:(0,_.jsx)($,{previewUrl:d(n.image,n.imgUrl,`component_${t}`),onChange:u,label:p("UploadComponentImage"),imageStyle:{backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"top"}})})}),(0,_.jsx)(a.Ay,{item:!0,xs:12,sm:8,children:(0,_.jsxs)(o.A,{display:"flex",flexDirection:"column",gap:2,children:[(0,_.jsx)(D.A,{label:p("ComponentName"),name:"name",value:n.name,onChange:m,fullWidth:!0,variant:"outlined",size:"small"}),(0,_.jsx)(D.A,{label:p("ComponentDescription"),name:"description",value:n.description,onChange:m,fullWidth:!0,variant:"outlined",size:"small",multiline:!0,rows:4}),(0,_.jsxs)(o.A,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,_.jsx)(L.A,{label:p("ComponentPrice"),value:n.price,onChange:e=>r({price:e}),size:"small",variant:"outlined"}),(0,_.jsx)(U.A,{onClick:c,size:"small",color:"error",children:(0,_.jsx)(z.A,{})})]})]})})]})})},H=s.memo(E),F=e=>{let{components:n,onComponentChange:t,onComponentImageChange:a,onAddComponent:i,onRemoveComponent:c,onReorderComponents:d,getPreviewUrl:p}=e;const{t:m}=(0,l.Bd)(),[u,h]=(0,s.useState)(1),[g,x]=(0,s.useState)(!1),v=(e,t)=>{const o="up"===t?e-1:e+1;if(o<0||o>=n.length)return;const a=[...n],[r]=a.splice(e,1);a.splice(o,0,r),d(a)},j=n.slice(20*(u-1),20*u);return(0,_.jsxs)(o.A,{children:[(0,_.jsx)(y.A,{variant:"h6",gutterBottom:!0,children:m("Components")}),j.map(((e,r)=>{const i=20*(u-1)+r;return(0,_.jsxs)(C.A,{expanded:g===i,onChange:()=>x(g!==i&&i),sx:{mb:2,boxShadow:"none",border:"1px solid #e0e0e0",borderRadius:"8px"},children:[(0,_.jsx)(b.A,{expandIcon:(0,_.jsx)(P.A,{}),children:(0,_.jsxs)(o.A,{display:"flex",alignItems:"center",width:"100%",children:[(0,_.jsx)(U.A,{size:"small",onClick:e=>{e.stopPropagation(),v(i,"up")},disabled:0===i,children:(0,_.jsx)(S.A,{fontSize:"small"})}),(0,_.jsx)(U.A,{size:"small",onClick:e=>{e.stopPropagation(),v(i,"down")},disabled:i===n.length-1,children:(0,_.jsx)(I.A,{fontSize:"small"})}),(0,_.jsx)(y.A,{sx:{ml:1},children:e.name||m("Unnamed Component")})]})}),(0,_.jsx)(k.A,{children:(0,_.jsx)(H,{component:e,index:i,onChange:e=>t(i,e),onImageChange:e=>a(i,e),onRemove:()=>c(i),getPreviewUrl:p})})]},e.id||`component-${i}`)})),(0,_.jsxs)(o.A,{mt:2,display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,_.jsx)(w.A,{count:Math.ceil(n.length/20),page:u,onChange:(e,n)=>h(n)}),(0,_.jsx)(r.A,{variant:"contained",color:"primary",onClick:i,startIcon:(0,_.jsx)(R.A,{}),disabled:(()=>{if(0===n.length)return!1;const e=n[n.length-1];return!e.name&&!e.description&&!e.price})(),children:m("AddComponent")})]})]})};var N=t(3193),q=t(8356),T=t(9285),G=t(1449),J=t(1052),Z=t(3536),K=t(4588);const Q=e=>{var n;let{product:t,onProductChange:r,onImageChange:c,previewUrl:d}=e;const{t:p}=(0,l.Bd)(),{showMessage:m}=(0,K.J)(),[u,h]=(0,s.useState)(t.description||""),[g,x]=(0,s.useState)(!1),v=(0,s.useCallback)((0,Z.debounce)((e=>{r({description:e}),m(p("Description saved successfully"),"success"),x(!1)}),500),[]);(0,s.useEffect)((()=>(g&&v(u),()=>{v.cancel()})),[u,g,v]);const A=e=>{const{name:n,value:t}=e.target;r({[n]:t})},f=(null===(n=(0,j.WC)().find((e=>"category"===(null===e||void 0===e?void 0:e.id))))||void 0===n?void 0:n.options)||[];return t?(0,_.jsx)(o.A,{children:(0,_.jsxs)(a.Ay,{container:!0,spacing:2,children:[(0,_.jsx)(a.Ay,{item:!0,xs:12,children:(0,_.jsx)($,{previewUrl:d,onChange:c,label:p("UploadProductImage"),imageStyle:{width:"100%",height:"200px",objectFit:"cover",borderRadius:"8px"}})}),(0,_.jsx)(a.Ay,{item:!0,xs:12,sm:6,children:(0,_.jsx)(D.A,{label:p("Name"),name:"name",value:t.name||"",onChange:A,fullWidth:!0,variant:"outlined"})}),(0,_.jsx)(a.Ay,{item:!0,xs:12,sm:6,children:(0,_.jsx)(L.A,{label:p("Price"),value:t.price,onChange:e=>r({price:e}),fullWidth:!0,variant:"outlined"})}),(0,_.jsx)(a.Ay,{item:!0,xs:12,sm:6,children:(0,_.jsxs)(N.A,{fullWidth:!0,variant:"outlined",children:[(0,_.jsx)(q.A,{children:p("Category")}),(0,_.jsx)(T.A,{label:p("Category"),name:"category",value:t.category||"",onChange:A,children:f.map((e=>(0,_.jsx)(G.A,{value:e.value,children:e.label},e.value)))})]})}),(0,_.jsx)(a.Ay,{item:!0,xs:12,sm:6,children:(0,_.jsxs)(N.A,{fullWidth:!0,variant:"outlined",children:[(0,_.jsx)(q.A,{children:p("Company")}),(0,_.jsxs)(T.A,{label:p("Company"),name:"company",value:t.company||"",onChange:A,children:[(0,_.jsx)(G.A,{value:"sermixer",children:p("Sermixer")}),(0,_.jsx)(G.A,{value:"s2_truck_service",children:p("S2TruckService")})]})]})}),(0,_.jsx)(a.Ay,{item:!0,xs:12,children:(0,_.jsx)(J.A,{label:p("Description"),name:"description",value:u,onChange:e=>{h(e),x(!0)},readOnly:!1,minRows:5,style:{border:g?"2px solid #f44336":"1px solid #ccc",transition:"border 0.3s ease"}})})]})}):(0,_.jsx)(i.A,{})},X=e=>{var n;let{initialProduct:t,onSave:d,loading:p,errorMessage:m,successMessage:u}=e;const{t:h}=(0,l.Bd)(),g=(0,c.Zp)(),[x,y]=(0,s.useState)({...t,components:t.components||[]}),[C,b]=(0,s.useState)({});(0,s.useEffect)((()=>{y({...t,components:t.components||[]})}),[t]),(0,s.useEffect)((()=>()=>{Object.values(C).forEach(URL.revokeObjectURL)}),[C,t]);const U=(0,s.useCallback)(((e,n,t)=>{if(e instanceof File){if(!C[t]){const n=URL.createObjectURL(e);return b((e=>({...e,[t]:n}))),n}return C[t]}return n||A}),[C]),k=(0,s.useCallback)((e=>{y((n=>({...n,...e})))}),[]),w=(e,n)=>{y((t=>{const o=t.components.map(((t,o)=>o===e?{...t,...n,image:n.image||t.image}:t));return{...t,components:o}}))},R=(null===(n=(0,j.WC)().find((e=>"category"===e.id)))||void 0===n?void 0:n.options)||[];return x?(0,_.jsx)(o.A,{children:(0,_.jsxs)(a.Ay,{container:!0,spacing:4,children:[(0,_.jsxs)(a.Ay,{item:!0,xs:12,children:[m&&(0,_.jsx)(f.A,{message:m,type:"error"}),u&&(0,_.jsx)(f.A,{message:u,type:"success"})]}),(0,_.jsx)(a.Ay,{item:!0,xs:12,md:6,children:(0,_.jsx)(Q,{product:x,onProductChange:k,onImageChange:e=>{if(e.target.files&&e.target.files[0]){const n=e.target.files[0];y((e=>({...e,image:n}))),C.mainProduct&&URL.revokeObjectURL(C.mainProduct);const t=URL.createObjectURL(n);b((e=>({...e,mainProduct:t})))}},categoryOptions:R,previewUrl:U(x.image,x.imgUrl,"mainProduct")})}),(0,_.jsx)(a.Ay,{item:!0,xs:12,md:6,children:(0,_.jsx)(F,{components:x.components,onComponentChange:w,onComponentImageChange:(e,n)=>{if(n.target.files&&n.target.files[0]){const t=n.target.files[0];w(e,{image:t}),C[`component_${e}`]&&URL.revokeObjectURL(C[`component_${e}`]);const o=URL.createObjectURL(t);b((n=>({...n,[`component_${e}`]:o})))}},onAddComponent:()=>{y((e=>{const n=[...e.components,{id:v(),name:"",price:0,description:""}];return{...e,components:n}}))},onRemoveComponent:e=>{y((n=>({...n,components:n.components.filter(((n,t)=>t!==e))})))},onReorderComponents:e=>{y((n=>({...n,components:e})))},getPreviewUrl:U})}),(0,_.jsx)(a.Ay,{item:!0,xs:12,children:(0,_.jsxs)(o.A,{display:"flex",justifyContent:"space-between",children:[(0,_.jsx)(r.A,{variant:"outlined",color:"primary",disabled:p,onClick:()=>g(-1),children:h("Back")}),(0,_.jsx)(r.A,{variant:"contained",color:"primary",disabled:p,onClick:e=>{e.preventDefault(),d({...x,image:x.image})},children:h("Save")})]})})]})}):(0,_.jsx)(i.A,{})},Y=s.memo(X)},2954:(e,n,t)=>{var o=t(4994);n.A=void 0;var a=o(t(39)),r=t(579);n.A=(0,a.default)((0,r.jsx)("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96M14 13v4h-4v-4H7l5-5 5 5z"}),"CloudUpload")},3471:(e,n,t)=>{var o=t(4994);n.A=void 0;var a=o(t(39)),r=t(579);n.A=(0,a.default)((0,r.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete")},7996:(e,n,t)=>{e.exports=t.p+"static/media/fallbackProduct.d869ab9fc469a3d71e51.png"}}]);
//# sourceMappingURL=280.b175881b.chunk.js.map